---
title: 小程序转发功能
tags: 小程序
abbrlink: 54747
date: 2018-01-07 19:05:16
categories:
---


小程序有两种转发形式,一种是右上角点击转发,另一种是通过按钮转发.

**右上角形式**
```js
//onload里设置这句 就会接收shareTicket 当然没有也会转发
wx.showShareMenu({
    withShareTicket: true
})


//只要在js定义了 onShareAppMessage 那么页面的右上角就会出现转发按钮 否则是没有转发的
onShareAppMessage: function () {
    return {
      title: '自定义转发标题',
      path: '/page/user?id=123',    //这个可以不设 不设的话就是当前页面地址
      success: function(res) {
        var shareTickets = res.shareTickets;
        if (shareTickets.length == 0) {
            return false;
        }
        // 这个是接收分享到所在群的的信息 这个需要解密等一些操作 下面只是简单演示 这个必须配合上面的 withShareTicket: true
        // 但是这个有啥用现在还没想清楚.
        wx.getShareInfo({
            shareTicket: shareTickets[0];
            success: function(res){
                var encryptedData = res.encryptedData;
                var iv = res.iv;
            }
        })
      },
      fail: function(res) {
        // 转发失败
      }
    }
 }

```

**按钮形式**
```js
//在wxml页面定义button
<button open-type="share">  "转发"</button>

//点击就会触发js的 onShareAppMessage()
//就会达到转发的效果
onShareAppMessage: function () {
    ....
}

```

## 参考文档
[微信小程序之转发流程详解](http://www.wxappclub.com/topic/1264)
[微信小程序页面内转发 按钮 转发](http://blog.csdn.net/mushui0633/article/details/74999346)
[微信小程序 转发功能的实现](http://www.jb51.net/article/120391.htm)
